# configuration.yaml snippets
# Add these blocks to your Home Assistant /homeassistant/configuration.yaml

# -------------------------------------------------------------------
# HTTP — allows HA to trust the socat/Tailscale proxy
# -------------------------------------------------------------------
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 127.0.0.1
    - 192.168.1.x   # Replace with your HA VM's local IP

# -------------------------------------------------------------------
# Shell Commands — run on HA, SSH into Mac Mini
# Replace YOUR_MAC_MINI_IP and yourusername with your actual values
# -------------------------------------------------------------------
shell_command:
  copy_snapshot_to_mac: >
    scp -i /config/ssh/id_ed25519 -o StrictHostKeyChecking=no
    /config/www/doorbell_latest.jpg
    yourusername@YOUR_MAC_MINI_IP:/Users/yourusername/ha_snapshots/doorbell_latest.jpg
  run_doorbell_uploader: >
    ssh -i /config/ssh/id_ed25519 -o StrictHostKeyChecking=no yourusername@YOUR_MAC_MINI_IP
    /Users/yourusername/miniconda3/bin/python3
    /Users/yourusername/slack_doorbell_uploader.py
